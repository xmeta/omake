<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>



<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.08">
<LINK rel="stylesheet" type="text/css" href="omake-doc.css">
<TITLE>
Autoconfiguration functions and variables
</TITLE>
</HEAD>
<BODY >

<img src="images/omake-manual.gif" border="0" align="top" alt=""><br>

<TABLE CELLSPACING=2 CELLPADDING=0>
<TR><TD ALIGN=left NOWRAP>Jump to:</TD>
<TD VALIGN=top ALIGN=center NOWRAP>&nbsp;&nbsp;</TD>
<TD ALIGN=left NOWRAP><A HREF="http://omake.metaprl.org/">OMake Home</A>
&bull;&nbsp;<A HREF="omake.html">Guide Home</A>
&bull;&nbsp;<A HREF="omake-doc.html">Guide (single-page)</A>
&bull;&nbsp;<A HREF="omake-toc.html">Contents (short)</A>
&bull;&nbsp;<A HREF="omake-contents.html">Contents (long)</A></TD>
</TR>
<TR><TD ALIGN=left NOWRAP>Index:</TD>
<TD VALIGN=top ALIGN=center NOWRAP>&nbsp;&nbsp;</TD>
<TD ALIGN=left NOWRAP><A HREF="omake-all-index.html">All</A>
&bull;&nbsp;<A HREF="omake-var-index.html">Variables</A>
&bull;&nbsp;<A HREF="omake-fun-index.html">Functions</A>
&bull;&nbsp;<A HREF="omake-obj-index.html">Objects</A>
&bull;&nbsp;<A HREF="omake-target-index.html">Targets</A>
&bull;&nbsp;<A HREF="omake-option-index.html">Options</A></TD>
</TR></TABLE>

<H1 CLASS="chapter"><A NAME="htoc376">Chapter&nbsp;13</A>&nbsp;&nbsp;Autoconfiguration functions and variables</H1><UL>
<LI><A HREF="omake-autoconf.html#toc100">General-purpose autoconfiguration functions</A>
<LI><A HREF="omake-autoconf.html#toc101">Predefined configuration tests</A>
</UL>

<A NAME="chapter:autoconf"></A>

OMake standard library provides a number of functions and variables intended to help one write
build specifications that need to be capable of autoconfiguring itself to adjust to different
build environments.<BR>
<BR>
<A NAME="toc100"></A>
<H2 CLASS="section"><A NAME="htoc377">13.1</A>&nbsp;&nbsp;General-purpose autoconfiguration functions</H2>
The following general-purpose functions can be used to discover the properties of your build
environment in a fashion similar to the one used by GNU autoconf tool you may be familiar with.
It is recommended that these function be used from an appropriate <CODE>static.</CODE> block (see
Section&nbsp;<A HREF="omake-language.html#section:static.">4.18</A> for more information).<BR>
<BR>
In order to use the following general-purpose functions, you need to have the line
<PRE CLASS="verbatim">
open configure/Configure
</PRE>included in your <CODE>OMakefile</CODE> or <CODE>OMakeroot</CODE>.

<H3 CLASS="subsection"><A NAME="htoc378">13.1.1</A>&nbsp;&nbsp;CheckHeader, VerboseCheckHeader</H3><A NAME="fun:CheckHeader"></A><A NAME="@default450"></A><A NAME="@fun253"></A><A NAME="fun:VerboseCheckHeader"></A><A NAME="@default451"></A><A NAME="@fun254"></A>
<PRE CLASS="verbatim">
success = $(CheckHeader &lt;files&gt;)
success = $(VerboseCheckHeader &lt;files&gt;)
</PRE>
Check whether your C compiler can locate and process the specified headers files.
Will use the <A HREF="omake-build.html#var:CC"><TT>CC</TT></A>, <A HREF="omake-build.html#var:CFLAGS"><TT>CFLAGS</TT></A> and <A HREF="omake-build.html#var:INCLUDES"><TT>INCLUDES</TT></A> variables 
to run the compiler. Will incude <CODE>&lt;stdio.h&gt;</CODE> before including the specified header files.<BR>
<BR>
Both functions return a boolean value. The <CODE>CheckHeader</CODE> function is silent; the
<CODE>VerboseCheckHeader</CODE> function will output a line describing the test and the outcome.<BR>
<BR>
Example:
<PRE CLASS="verbatim">
static. =
   NCURSES_H_AVAILABLE = $(VerboseCheckHeader ncurses.h)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc379">13.1.2</A>&nbsp;&nbsp;CheckLib, VerboseCheckLib</H3><A NAME="fun:CheckLib"></A><A NAME="@default452"></A><A NAME="@fun255"></A><A NAME="fun:VerboseCheckLib"></A><A NAME="@default453"></A><A NAME="@fun256"></A>
<PRE CLASS="verbatim">
success = $(CheckLib &lt;libs&gt;, &lt;functions&gt;)
success = $(VerboseCheckLib &lt;libs&gt;, &lt;functions&gt;)
</PRE>
Check whether your C compiler and linker can find the named functions when linking with
the named libraries.
Will use the <A HREF="omake-build.html#var:CC"><TT>CC</TT></A>, <A HREF="omake-build.html#var:CFLAGS"><TT>CFLAGS</TT></A> and <A HREF="omake-build.html#var:LDFLAGS"><TT>LDFLAGS</TT></A> variables 
to run the compiler. Will pass the <CODE>&lt;libs&gt;</CODE> to the compiler using the <CODE>-l</CODE> flag.<BR>
<BR>
Both functions return a boolean value. The <CODE>CheckLib</CODE> function is silent; the
<CODE>VerboseCheckLib</CODE> function will output a line describing the test and the outcome.<BR>
<BR>
Example:
<PRE CLASS="verbatim">
static. =
    NCURSES_LIB_AVAILABLE = $(VerboseCheckLib ncurses, initscr setupterm tigetstr)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc380">13.1.3</A>&nbsp;&nbsp;CheckProg</H3><A NAME="fun:CheckProg"></A><A NAME="@default454"></A><A NAME="@fun257"></A>
<CODE>success = $(CheckProg &lt;prog&gt;)</CODE><BR>
<BR>
Checks whether the program <CODE>&lt;prog&gt;</CODE> exists in your path. Will output a line describing the
test and the outcome.<BR>
<BR>
<A NAME="toc101"></A>
<H2 CLASS="section"><A NAME="htoc381">13.2</A>&nbsp;&nbsp;Predefined configuration tests</H2>
A number of configuration tests are already included in the standard library.
In order to use them in your project, simply <CODE>open</CODE> (see Section&nbsp;<A HREF="omake-language.html#section:include">4.7</A>) the
corresponding build file in your <CODE>OMakefile</CODE> and the tests will run the first time OMake
is executed. Note that it is not a problem to <CODE>open</CODE> these files from more than one place in
your project &mdash; if you do that, the test will still run only once.

<H3 CLASS="subsection"><A NAME="htoc382">13.2.1</A>&nbsp;&nbsp;NCurses library configuration</H3>
Add <CODE>open configure/ncurses</CODE> line to your <CODE>OMakefile</CODE> to get access to the following
autoconfiguration variables.

<H5 CLASS="paragraph">NCURSES_AVAILABLE</H5><A NAME="var:NCURSES_AVAILABLE"></A><A NAME="@default455"></A><A NAME="@var109"></A> A boolean flag that would be set when both
the <CODE>curses.h</CODE> header, the <CODE>term.h</CODE> header, and the <CODE>ncurses</CODE> library very found.<BR>
<BR>

<H5 CLASS="paragraph">NCURSES_TERMH_IN_NCURSES</H5><A NAME="var:NCURSES_TERMH_IN_NCURSES"></A><A NAME="@default456"></A><A NAME="@var110"></A> A boolean flag that would be set
when <CODE>term.h</CODE> has to be included as <CODE>&lt;ncurses/term.h&gt;</CODE> instead of <CODE>&lt;term.h&gt;</CODE>.

<H3 CLASS="subsection"><A NAME="htoc383">13.2.2</A>&nbsp;&nbsp;ReadLine library configuration</H3>
Add <CODE>open configure/readline</CODE> line to your <CODE>OMakefile</CODE> to get access to the following
autoconfiguration variables.

<H5 CLASS="paragraph">READLINE_AVAILABLE</H5><A NAME="var:READLINE_AVAILABLE"></A><A NAME="@default457"></A><A NAME="@var111"></A> A boolean flag that would be set when both
the <CODE>readline/readline.h</CODE> header, the <CODE>readline/history.h</CODE> header, and the <CODE>readline</CODE>
library very found.<BR>
<BR>

<H5 CLASS="paragraph">READLINE_GNU</H5><A NAME="var:READLINE_GNU"></A><A NAME="@default458"></A><A NAME="@var112"></A> A boolean flag that would be set
when the GNU version of the readline library is found (as opposed to the BSD one).<BR>
<BR>

<H5 CLASS="paragraph">READLINE_CFLAGS</H5><A NAME="var:READLINE_CFLAGS"></A><A NAME="@default459"></A><A NAME="@var113"></A> The <CODE>CFLAGS</CODE> to use when compiling readline code.
Will include <CODE>-DREADLINE_ENABLED</CODE> and <CODE>-DREADLINE_GNU</CODE>, respectively
when <CODE>READLINE_AVAILABLE</CODE> and <CODE>READLINE_GNU</CODE> are true.<BR>
<BR>

<H5 CLASS="paragraph">READLINE_CLIBS</H5><A NAME="var:READLINE_CLIBS"></A><A NAME="@default460"></A><A NAME="@var114"></A> The <CODE>LDFLAGS</CODE> to use when linking readline code.
Will normally contain <CODE>-lncurses -lreadline</CODE> when readline is found and remain empty otherwise.

<H3 CLASS="subsection"><A NAME="htoc384">13.2.3</A>&nbsp;&nbsp;Snprintf configuration</H3>
Add <CODE>open configure/snprintf</CODE> line to your <CODE>OMakefile</CODE> to get access to the following
autoconfiguration variables.

<H5 CLASS="paragraph">SNPRINTF_AVAILABLE</H5><A NAME="var:SNPRINTF_AVAILABLE"></A><A NAME="@default461"></A><A NAME="@var115"></A> A boolean flag telling whether the snprintf
function is available in the standard C library.<BR>
<BR>


<TABLE CELLSPACING=2 CELLPADDING=0>
<TR><TD ALIGN=left NOWRAP>Jump to:</TD>
<TD VALIGN=top ALIGN=center NOWRAP>&nbsp;&nbsp;</TD>
<TD ALIGN=left NOWRAP><A HREF="http://omake.metaprl.org/">OMake Home</A>
&bull;&nbsp;<A HREF="omake.html">Guide Home</A>
&bull;&nbsp;<A HREF="omake-doc.html">Guide (single-page)</A>
&bull;&nbsp;<A HREF="omake-toc.html">Contents (short)</A>
&bull;&nbsp;<A HREF="omake-contents.html">Contents (long)</A></TD>
</TR>
<TR><TD ALIGN=left NOWRAP>Index:</TD>
<TD VALIGN=top ALIGN=center NOWRAP>&nbsp;&nbsp;</TD>
<TD ALIGN=left NOWRAP><A HREF="omake-all-index.html">All</A>
&bull;&nbsp;<A HREF="omake-var-index.html">Variables</A>
&bull;&nbsp;<A HREF="omake-fun-index.html">Functions</A>
&bull;&nbsp;<A HREF="omake-obj-index.html">Objects</A>
&bull;&nbsp;<A HREF="omake-target-index.html">Targets</A>
&bull;&nbsp;<A HREF="omake-option-index.html">Options</A></TD>
</TR></TABLE>
</BODY>
</HTML>
