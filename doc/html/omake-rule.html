<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>



<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.08">
<LINK rel="stylesheet" type="text/css" href="omake-doc.css">
<TITLE>
Build functions
</TITLE>
</HEAD>
<BODY >

<img src="images/omake-manual.gif" border="0" align="top"><br>

<TABLE CELLSPACING=2 CELLPADDING=0>
<TR><TD ALIGN=left NOWRAP>Jump to:</TD>
<TD VALIGN=top ALIGN=center NOWRAP>&nbsp;&nbsp;</TD>
<TD ALIGN=left NOWRAP><A HREF="http://omake.metaprl.org/">OMake Home</A>
&bull;&nbsp;<A HREF="omake.html">Guide Home</A>
&bull;&nbsp;<A HREF="omake-doc.html">Guide (single-page)</A>
&bull;&nbsp;<A HREF="omake-toc.html">Contents (short)</A>
&bull;&nbsp;<A HREF="omake-contents.html">Contents (long)</A></TD>
</TR>
<TR><TD ALIGN=left NOWRAP>Index:</TD>
<TD VALIGN=top ALIGN=center NOWRAP>&nbsp;&nbsp;</TD>
<TD ALIGN=left NOWRAP><A HREF="omake-all-index.html">All</A>
&bull;&nbsp;<A HREF="omake-var-index.html">Variables</A>
&bull;&nbsp;<A HREF="omake-fun-index.html">Functions</A>
&bull;&nbsp;<A HREF="omake-obj-index.html">Objects</A>
&bull;&nbsp;<A HREF="omake-target-index.html">Targets</A></TD>
</TR></TABLE>

<H1 CLASS="chapter"><A NAME="htoc303">Chapter&nbsp;11</A>&nbsp;&nbsp;Build functions</H1><UL>
<LI><A HREF="omake-rule.html#toc79">Options and versioning</A>
<LI><A HREF="omake-rule.html#toc80">The OMakeroot file</A>
<LI><A HREF="omake-rule.html#toc81">Building C programs</A>
<LI><A HREF="omake-rule.html#toc82">Building OCaml programs</A>
<LI><A HREF="omake-rule.html#toc83">Building L<sup>A</sup>T<sub>E</sub>X programs</A>
<LI><A HREF="omake-rule.html#toc84">Examining the dependency graph</A>
</UL>

<A NAME="chapter:rule"></A>

<A NAME="toc79"></A>
<H2 CLASS="section"><A NAME="htoc304">11.1</A>&nbsp;&nbsp;Options and versioning</H2>

<H3 CLASS="subsection"><A NAME="htoc305">11.1.1</A>&nbsp;&nbsp;OMakeFlags</H3><A NAME="@default269"></A><A NAME="@fun185"></A><A NAME="fun:OMakeFlags"></A>
<PRE CLASS="verbatim">
   OMakeFlags(options)
      options : String
</PRE>
The <CODE>OMakeFlags</CODE> function is used to set <CODE>omake</CODE> options from
within <TT>OMakefile</TT>s. The options have exactly the same format as
options on the command line.<BR>
<BR>
For example, the following code displays the progress bar unless
the <CODE>VERBOSE</CODE> environment variable is defined.
<PRE CLASS="verbatim">
    if $(not $(defined-env VERBOSE))
        OMakeFlags(-S --progress)
        export
</PRE>
<H3 CLASS="subsection"><A NAME="htoc306">11.1.2</A>&nbsp;&nbsp;OMakeVersion</H3><A NAME="@default270"></A><A NAME="@fun186"></A><A NAME="fun:OMakeVersion"></A>
<PRE CLASS="verbatim">
   OMakeVersion(version1)
   OMakeVersion(version1, version2)
      version1, version2 : String
</PRE>
The <CODE>OMakeVersion</CODE> function is used for version checking
in <TT>OMakefile</TT>s. It takes one or two arguments.<BR>
<BR>
In the one argument form, if the <TT>omake</TT> version number
is less than <CODE>&lt;version1&gt;</CODE>,
then an exception is raised. In the two argument form,
the version must lie between <CODE>version1</CODE> and <CODE>version2</CODE>.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc307">11.1.3</A>&nbsp;&nbsp;cmp-versions</H3><A NAME="@default271"></A><A NAME="@fun187"></A><A NAME="fun:cmp-versions"></A>
<PRE CLASS="verbatim">
   $(cmp-versions version1, version2)
      version1, version2 : String
</PRE>
The <CODE>cmp-versions\</CODE> functions can be used to compare arbitrary version strings.
It returns 0 when the two version strings are equal, a negative number when the first
string represents an earlier version, and a positive number otherwise.

<H3 CLASS="subsection"><A NAME="htoc308">11.1.4</A>&nbsp;&nbsp;DefineCommandVars</H3><A NAME="@default272"></A><A NAME="@fun188"></A><A NAME="fun:DefineCommandVars"></A>
<PRE CLASS="verbatim">
   DefineCommandVars()
</PRE>
The <CODE>DefineCommandVars</CODE> function redefines the variables passed on
the commandline. Variables definitions are passed on the command line
in the form <CODE>name=value</CODE>. This function is primarily for internal
use by <TT>omake</TT> to define these variables for the first time.
<A NAME="toc80"></A>
<H2 CLASS="section"><A NAME="htoc309">11.2</A>&nbsp;&nbsp;The OMakeroot file</H2>
<A NAME="@default273"></A>
The standard <TT>OMakeroot</TT> file defines the functions are rules
for building standard projects.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc310">11.2.1</A>&nbsp;&nbsp;Variables</H3>

<H3 CLASS="subsection"><A NAME="htoc311">11.2.2</A>&nbsp;&nbsp;ROOT</H3><A NAME="@default274"></A><A NAME="@var14"></A><A NAME="var:ROOT"></A> The root directory of the current project.

<H3 CLASS="subsection"><A NAME="htoc312">11.2.3</A>&nbsp;&nbsp;CWD</H3><A NAME="@default275"></A><A NAME="@var15"></A><A NAME="var:CWD"></A> The current working directory (the directory is set for each <TT>OMakefile</TT> in the project).

<H3 CLASS="subsection"><A NAME="htoc313">11.2.4</A>&nbsp;&nbsp;EMPTY</H3><A NAME="@default276"></A><A NAME="@var16"></A><A NAME="var:EMPTY"></A> The empty string.

<H3 CLASS="subsection"><A NAME="htoc314">11.2.5</A>&nbsp;&nbsp;STDROOT</H3><A NAME="@default277"></A><A NAME="@var17"></A><A NAME="var:STDROOT"></A> The name of the standard installed <TT>OMakeroot</TT> file.

<H3 CLASS="subsection"><A NAME="htoc315">11.2.6</A>&nbsp;&nbsp;VERBOSE</H3><A NAME="@default278"></A><A NAME="@var18"></A><A NAME="var:VERBOSE"></A> Whether certain commands should be verbose (<CODE>false</CODE> by default).

<H3 CLASS="subsection"><A NAME="htoc316">11.2.7</A>&nbsp;&nbsp;ABORT_ON_COMMAND_ERROR</H3><A NAME="@default279"></A><A NAME="@var19"></A><A NAME="var:ABORT_ON_COMMAND_ERROR"></A> If set to true, the construction of a target should
 be aborted whenever one of the commands to build it fail. This defaults to true,
 and should normally be left that way.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc317">11.2.8</A>&nbsp;&nbsp;SCANNER_MODE</H3><A NAME="@default280"></A><A NAME="@var20"></A><A NAME="var:SCANNER_MODE"></A> This variable should be defined as one of four values
 (defaults to <CODE>enabled</CODE>).
<DL CLASS="description" COMPACT=compact><DT CLASS="dt-description">
<B>enabled</B><DD CLASS="dd-description"> Allow the use of default <CODE>.SCANNER</CODE> rules. Whenever a rule does
 not specify a <CODE>:scanner:</CODE> dependency explicitly, try to find a
 <CODE>.SCANNER</CODE> with the same target name.
<DT CLASS="dt-description"><B>disabled</B><DD CLASS="dd-description"> Never use default <CODE>.SCANNER</CODE> rules.
<DT CLASS="dt-description"><B>warning</B><DD CLASS="dd-description"> Allow the use of default <CODE>.SCANNER</CODE> rules, but print a warning
 whenever one is selected.
<DT CLASS="dt-description"><B>error</B><DD CLASS="dd-description"> Do not allow the use of default <CODE>.SCANNER</CODE> rules. If a rule
 does not specify a <CODE>:scanner:</CODE> dependency, and there is a default
 <CODE>.SCANNER</CODE> rule, the build will terminate abnormally.
</DL>

<H3 CLASS="subsection"><A NAME="htoc318">11.2.9</A>&nbsp;&nbsp;System variables</H3>

<H3 CLASS="subsection"><A NAME="htoc319">11.2.10</A>&nbsp;&nbsp;INSTALL</H3><A NAME="@default281"></A><A NAME="@var21"></A><A NAME="var:INSTALL"></A> The command to install a program (<CODE>install</CODE> on <CODE>Unix</CODE>, <CODE>cp</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc320">11.2.11</A>&nbsp;&nbsp;PATHSEP</H3><A NAME="@default282"></A><A NAME="@var22"></A><A NAME="var:PATHSEP"></A> The normal path separator (<CODE>:</CODE> on <CODE>Unix</CODE>, <CODE>;</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc321">11.2.12</A>&nbsp;&nbsp;DIRSEP</H3><A NAME="@default283"></A><A NAME="@var23"></A><A NAME="var:DIRSEP"></A> The normal directory separator (<CODE>/</CODE> on <CODE>Unix</CODE>, <CODE>\</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc322">11.2.13</A>&nbsp;&nbsp;EXT_LIB</H3><A NAME="@default284"></A><A NAME="@var24"></A><A NAME="var:EXT_LIB"></A> File suffix for a static library (default is <CODE>.a</CODE> on <CODE>Unix</CODE>, and <CODE>.lib</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc323">11.2.14</A>&nbsp;&nbsp;EXT_OBJ</H3><A NAME="@default285"></A><A NAME="@var25"></A><A NAME="var:EXT_OBJ"></A> File suffix for an object file (default is <CODE>.o</CODE> on <CODE>Unix</CODE>, and <CODE>.obj</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc324">11.2.15</A>&nbsp;&nbsp;EXT_ASM</H3><A NAME="@default286"></A><A NAME="@var26"></A><A NAME="var:EXT_ASM"></A> File suffix for an assembly file (default is <CODE>.s</CODE> on <CODE>Unix</CODE>, and <CODE>.asm</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc325">11.2.16</A>&nbsp;&nbsp;EXE</H3><A NAME="@default287"></A><A NAME="@var27"></A><A NAME="var:EXE"></A> File suffix for executables (default is empty for <CODE>Unix</CODE>, and <CODE>.exe</CODE> on <CODE>Win32</CODE> and <CODE>Cygwin</CODE>).
<A NAME="toc81"></A>
<H2 CLASS="section"><A NAME="htoc326">11.3</A>&nbsp;&nbsp;Building C programs</H2>
<TT>omake</TT> provides extensive support for building C programs.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc327">11.3.1</A>&nbsp;&nbsp;C configuration variables</H3>
The following variables can be redefined in your project.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc328">11.3.2</A>&nbsp;&nbsp;CC</H3><A NAME="@default288"></A><A NAME="@var28"></A><A NAME="var:CC"></A> The name of the C compiler (on <CODE>Unix</CODE> it defaults to <CODE>gcc</CODE> when <CODE>gcc</CODE> is present and
 to <CODE>cc</CODE> otherwise; on <CODE>Win32</CODE> defaults to <CODE>cl /nologo</CODE>).

<H3 CLASS="subsection"><A NAME="htoc329">11.3.3</A>&nbsp;&nbsp;CXX</H3><A NAME="@default289"></A><A NAME="@var29"></A><A NAME="var:CXX"></A> The name of the C++ compiler (on <CODE>Unix</CODE> it defaults to <CODE>gcc</CODE> when <CODE>gcc</CODE> is present
 and to <CODE>c</CODE>++ otherwise; on <CODE>Win32</CODE> defaults to <CODE>cl /nologo</CODE>).

<H3 CLASS="subsection"><A NAME="htoc330">11.3.4</A>&nbsp;&nbsp;CPP</H3><A NAME="@default290"></A><A NAME="@var30"></A><A NAME="var:CPP"></A> The name of the C preprocessor (defaults to <CODE>cpp</CODE> on <CODE>Unix</CODE>, and <CODE>cl /E</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc331">11.3.5</A>&nbsp;&nbsp;CFLAGS</H3><A NAME="@default291"></A><A NAME="@var31"></A><A NAME="var:CFLAGS"></A> Compilation flags to pass to the C compiler (default empty on <CODE>Unix</CODE>, and <CODE>/DWIN32</CODE>
 on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc332">11.3.6</A>&nbsp;&nbsp;CXXFLAGS</H3><A NAME="@default292"></A><A NAME="@var32"></A><A NAME="var:CXXFLAGS"></A> Compilation flags to pass to the C++ compiler (default empty on <CODE>Unix</CODE>, and <CODE>/DWIN32</CODE>
 on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc333">11.3.7</A>&nbsp;&nbsp;INCLUDES</H3><A NAME="@default293"></A><A NAME="@var33"></A><A NAME="var:INCLUDES"></A> Additional directories that specify the search path to the C and C++ compilers (default is <CODE>.</CODE>).
 The directories are passed to the C and C++ compilers with the <CODE>-I</CODE> option.
 The include path with <CODE>-I</CODE> prefixes is defined in the <CODE>PREFIXED_INCLUDES</CODE> variable.

<H3 CLASS="subsection"><A NAME="htoc334">11.3.8</A>&nbsp;&nbsp;LIBS</H3><A NAME="@default294"></A><A NAME="@var34"></A><A NAME="var:LIBS"></A> Additional libraries needed when building a program (default is empty).

<H3 CLASS="subsection"><A NAME="htoc335">11.3.9</A>&nbsp;&nbsp;AS</H3><A NAME="@default295"></A><A NAME="@var35"></A><A NAME="var:AS"></A> The name of the assembler (defaults to <CODE>as</CODE> on <CODE>Unix</CODE>, and <CODE>ml</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc336">11.3.10</A>&nbsp;&nbsp;ASFLAGS</H3><A NAME="@default296"></A><A NAME="@var36"></A><A NAME="var:ASFLAGS"></A> Flags to pass to the assembler (default is empty on <CODE>Unix</CODE>, and <CODE>/c /coff</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc337">11.3.11</A>&nbsp;&nbsp;AR</H3><A NAME="@default297"></A><A NAME="@var37"></A><A NAME="var:AR"></A> The name of the program to create static libraries (defaults to <CODE>ar cq</CODE> on <CODE>Unix</CODE>,
 and <CODE>lib</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc338">11.3.12</A>&nbsp;&nbsp;AROUT</H3><A NAME="@default298"></A><A NAME="@var38"></A><A NAME="var:AROUT"></A> The option string that specifies the output file for <CODE>AR</CODE>.

<H3 CLASS="subsection"><A NAME="htoc339">11.3.13</A>&nbsp;&nbsp;LD</H3><A NAME="@default299"></A><A NAME="@var39"></A><A NAME="var:LD"></A> The name of the linker (defaults to <CODE>ld</CODE> on <CODE>Unix</CODE>, and <CODE>cl</CODE> on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc340">11.3.14</A>&nbsp;&nbsp;LDFLAGS</H3><A NAME="@default300"></A><A NAME="@var40"></A><A NAME="var:LDFLAGS"></A> Options to pass to the linker (default is empty).

<H3 CLASS="subsection"><A NAME="htoc341">11.3.15</A>&nbsp;&nbsp;YACC</H3><A NAME="@default301"></A><A NAME="@var41"></A><A NAME="var:YACC"></A> The name of the <CODE>yacc</CODE> parser generator (default is <CODE>yacc</CODE> on <CODE>Unix</CODE>, empty on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc342">11.3.16</A>&nbsp;&nbsp;LEX</H3><A NAME="@default302"></A><A NAME="@var42"></A><A NAME="var:LEX"></A> The name of the <CODE>lex</CODE> lexer generator (default is <CODE>lex</CODE> on <CODE>Unix</CODE>, empty on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc343">11.3.17</A>&nbsp;&nbsp;CGeneratedFiles</H3><A NAME="@default303"></A><A NAME="@fun189"></A><A NAME="fun:CGeneratedFiles"></A>

<H3 CLASS="subsection"><A NAME="htoc344">11.3.18</A>&nbsp;&nbsp;LocalCGeneratedFiles</H3><A NAME="@default304"></A><A NAME="@fun190"></A><A NAME="fun:LocalCGeneratedFiles"></A>
<PRE CLASS="verbatim">
CGeneratedFiles(files)
LocalCGeneratedFiles(files)
</PRE>
The <CODE>CGeneratedFiles</CODE> and <CODE>LocalCGeneratedFiles</CODE> functions specify files
that need to be generated before any C files are scanned for dependencies. For example,
if <CODE>config.h</CODE> and <CODE>inputs.h</CODE> are both generated files, specify:
<PRE CLASS="verbatim">
CGeneratedFiles(config.h inputs.h)
</PRE>
The <CODE>CGeneratedFiles</CODE> function is <EM>global</EM> &mdash; its arguments will be generated
before any C files anywhere in the project are scanned for dependencies. The
<CODE>LocalCGeneratedFiles</CODE> function follows the normal scoping rules of OMake.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc345">11.3.19</A>&nbsp;&nbsp;StaticCLibrary</H3><A NAME="@default305"></A><A NAME="@fun191"></A><A NAME="fun:StaticCLibrary"></A>
The <CODE>StaticCLibrary</CODE> builds a static library.<BR>
<BR>
<CODE>StaticCLibrary(&lt;target&gt;, &lt;files&gt;)</CODE><BR>
<BR>
The <CODE>&lt;target&gt;</CODE> does <EM>not</EM> include the library suffix, and
The <CODE>&lt;files&gt;</CODE> list does not include the object suffix. These
are obtained from the <CODE>EXT_LIB</CODE> and <CODE>EXT_OBJ</CODE> variables.<BR>
<BR>
This function returns the library filename.<BR>
<BR>
The following command builds the library <CODE>libfoo.a</CODE> from the
files <CODE>a.o b.o c.o</CODE> on <CODE>Unix</CODE>, or the library
<CODE>libfoo.lib</CODE> from the files <CODE>a.obj b.obj c.obj</CODE>
on <CODE>Win32</CODE>.
<PRE CLASS="verbatim">
StaticCLibrary(libfoo, a b c)
.DEFAULT: $(StaticCLibrary libbar, a b c d)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc346">11.3.20</A>&nbsp;&nbsp;StaticCLibraryCopy</H3><A NAME="@default306"></A><A NAME="@fun192"></A><A NAME="fun:StaticCLibraryCopy"></A>
The <CODE>StaticCLibraryCopy</CODE> function copies the static library
to an install location.<BR>
<BR>
<CODE>StaticCLibraryCopy(&lt;tag&gt;, &lt;dir&gt;, &lt;lib&gt;)</CODE><BR>
<BR>
The <CODE>&lt;tag&gt;</CODE> is the name of a target (typically a <CODE>.PHONY</CODE> target);
the <CODE>&lt;dir&gt;</CODE> is the installation directory, and <CODE>&lt;lib&gt;</CODE> is
the library to be copied (without the library suffix).<BR>
<BR>
This function returns the filename of the library in the target directory.<BR>
<BR>
For example, the following code copies the library
<CODE>libfoo.a</CODE> to the <CODE>/usr/lib</CODE> directory.
<PRE CLASS="verbatim">
.PHONY: install

StaticCLibraryCopy(install, /usr/lib, libfoo)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc347">11.3.21</A>&nbsp;&nbsp;StaticCLibraryInstall</H3><A NAME="@default307"></A><A NAME="@fun193"></A><A NAME="fun:StaticCLibraryInstall"></A>
The <CODE>StaticCLibraryInstall</CODE> function builds a library, and
sets the install location in one step. It returns the filename of the library
in the target directory.<BR>
<BR>
<CODE>StaticCLibraryInstall(&lt;tag&gt;, &lt;dir&gt;, &lt;libname&gt;, &lt;files&gt;)</CODE>
<PRE CLASS="verbatim">
StaticCLibraryInstall(install, /usr/lib, libfoo, a b c)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc348">11.3.22</A>&nbsp;&nbsp;StaticCObject</H3><A NAME="@default308"></A><A NAME="@fun194"></A><A NAME="fun:StaticCObject"></A>

<H3 CLASS="subsection"><A NAME="htoc349">11.3.23</A>&nbsp;&nbsp;StaticCObjectCopy</H3><A NAME="@default309"></A><A NAME="@fun195"></A><A NAME="fun:StaticCObjectCopy"></A>

<H3 CLASS="subsection"><A NAME="htoc350">11.3.24</A>&nbsp;&nbsp;StaticCObjectInstall</H3><A NAME="@default310"></A><A NAME="@fun196"></A><A NAME="fun:StaticCObjectInstall"></A>
These functions mirror the <CODE>StaticCLibrary</CODE>, <CODE>StaticCLibraryCopy</CODE>,
and <CODE>StaticCLibraryInstall</CODE> functions, but they build an <EM>object</EM>
file (a <CODE>.o</CODE> file on <CODE>Unix</CODE>, and a <CODE>.obj</CODE> file on <CODE>Win32</CODE>).

<H3 CLASS="subsection"><A NAME="htoc351">11.3.25</A>&nbsp;&nbsp;CProgram</H3><A NAME="@default311"></A><A NAME="@fun197"></A><A NAME="fun:CProgram"></A>
The <CODE>CProgram</CODE> function builds a C program from a set
of object files and libraries.<BR>
<BR>
<CODE>CProgram(&lt;name&gt;, &lt;files&gt;)</CODE><BR>
<BR>
The <CODE>&lt;name&gt;</CODE> argument specifies the name of the program to be built;
the <CODE>&lt;files&gt;</CODE> argument specifies the files to be linked. The function
returns the filename of the executable.<BR>
<BR>
Additional options can be passed through the following variables.
<DL CLASS="description" COMPACT=compact><DT CLASS="dt-description">
<B>CFLAGS</B><DD CLASS="dd-description"> Flags used by the C compiler during the link step.
<DT CLASS="dt-description"><B>LDFLAGS</B><DD CLASS="dd-description"> Flags to pass to the loader.
<DT CLASS="dt-description"><B>LIBS</B><DD CLASS="dd-description"> Additional libraries to be linked.
</DL>
For example, the following code specifies that the program
<CODE>foo</CODE> is to be produced by linking the files <CODE>bar.o</CODE>
and <CODE>baz.o</CODE> and libraries <CODE>libfoo.a</CODE>.
<PRE CLASS="verbatim">
section
   LIBS = libfoo$(EXT_LIB)
   CProgram(foo, bar baz)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc352">11.3.26</A>&nbsp;&nbsp;CProgramCopy</H3><A NAME="@default312"></A><A NAME="@fun198"></A><A NAME="fun:CProgramCopy"></A>
The <CODE>CProgramCopy</CODE> function copies a file to an install location.<BR>
<BR>
<CODE>CProgramCopy(&lt;tag&gt;, &lt;dir&gt;, &lt;program&gt;)</CODE>
<PRE CLASS="verbatim">
CProgramCopy(install, /usr/bin, foo)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc353">11.3.27</A>&nbsp;&nbsp;CProgramInstall</H3><A NAME="@default313"></A><A NAME="@fun199"></A><A NAME="fun:CProgramInstall"></A>
The <CODE>CProgramInstall</CODE> function specifies a program to build,
and a location to install, simultaneously.<BR>
<BR>
<CODE>CProgramInstall(&lt;tag&gt;, &lt;dir&gt;, &lt;name&gt;, &lt;files&gt;)</CODE>
<PRE CLASS="verbatim">
section
   LIBS = libfoo$(EXT_LIB)
   CProgramInstall(install, /usr/bin, foo, bar baz)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc354">11.3.28</A>&nbsp;&nbsp;CXXProgram</H3><A NAME="@default314"></A><A NAME="@fun200"></A><A NAME="fun:CXXProgram"></A>

<H3 CLASS="subsection"><A NAME="htoc355">11.3.29</A>&nbsp;&nbsp;CXXProgramInstall</H3><A NAME="@default315"></A><A NAME="@fun201"></A><A NAME="fun:CXXProgramInstall"></A>
The <CODE>CXXProgram</CODE> and <CODE>CXXProgramInstall</CODE> functions are
equivalent to their C counterparts, except that would use <CODE>$(CXX)</CODE> and <CODE>$(CXXFLAGS)</CODE>
for linking instead of <CODE>$(CC)</CODE> and <CODE>$(CFLAGS)</CODE>.
<A NAME="toc82"></A>
<H2 CLASS="section"><A NAME="htoc356">11.4</A>&nbsp;&nbsp;Building OCaml programs</H2>

<H3 CLASS="subsection"><A NAME="htoc357">11.4.1</A>&nbsp;&nbsp;Variables for OCaml programs</H3>
The following variables can be redefined in your project.

<H3 CLASS="subsection"><A NAME="htoc358">11.4.2</A>&nbsp;&nbsp;USE_OCAMLFIND</H3><A NAME="@default316"></A><A NAME="@var43"></A><A NAME="var:USE_OCAMLFIND"></A> Whether to use the <CODE>ocamlfind</CODE> utility (default <CODE>false\</CODE>)

<H3 CLASS="subsection"><A NAME="htoc359">11.4.3</A>&nbsp;&nbsp;OCAMLC</H3><A NAME="@default317"></A><A NAME="@var44"></A><A NAME="var:OCAMLC"></A> The OCaml bytecode compiler (default <CODE>ocamlc.opt</CODE> if it exists
 and <CODE>USE_OCAMLFIND</CODE> is not set, otherwise <CODE>ocamlc</CODE>).

<H3 CLASS="subsection"><A NAME="htoc360">11.4.4</A>&nbsp;&nbsp;OCAMLOPT</H3><A NAME="@default318"></A><A NAME="@var45"></A><A NAME="var:OCAMLOPT"></A> The OCaml native-code compiler (default <CODE>ocamlopt.opt</CODE> if it
 exists and <CODE>USE_OCAMLFIND</CODE> is not set, otherwise <CODE>ocamlopt</CODE>).

<H3 CLASS="subsection"><A NAME="htoc361">11.4.5</A>&nbsp;&nbsp;CAMLP4</H3><A NAME="@default319"></A><A NAME="@var46"></A><A NAME="var:CAMLP4"></A> The <CODE>camlp4</CODE> preprocessor (default <CODE>camlp4</CODE>).

<H3 CLASS="subsection"><A NAME="htoc362">11.4.6</A>&nbsp;&nbsp;OCAMLLEX</H3><A NAME="@default320"></A><A NAME="@var47"></A><A NAME="var:OCAMLLEX"></A> The OCaml lexer generator (default <CODE>ocamllex</CODE>).

<H3 CLASS="subsection"><A NAME="htoc363">11.4.7</A>&nbsp;&nbsp;OCAMLLEXFLAGS</H3><A NAME="@default321"></A><A NAME="@var48"></A><A NAME="var:OCAMLLEXFLAGS"></A> The flags to pass to <CODE>ocamllex</CODE> (default <CODE>-q</CODE>).

<H3 CLASS="subsection"><A NAME="htoc364">11.4.8</A>&nbsp;&nbsp;OCAMLYACC</H3><A NAME="@default322"></A><A NAME="@var49"></A><A NAME="var:OCAMLYACC"></A> The OCaml parser generator (default <CODE>ocamlyacc</CODE>).

<H3 CLASS="subsection"><A NAME="htoc365">11.4.9</A>&nbsp;&nbsp;OCAMLDEP</H3><A NAME="@default323"></A><A NAME="@var50"></A><A NAME="var:OCAMLDEP"></A> The OCaml dependency analyzer (default <CODE>ocamldep</CODE>).

<H3 CLASS="subsection"><A NAME="htoc366">11.4.10</A>&nbsp;&nbsp;OCAMLMKTOP</H3><A NAME="@default324"></A><A NAME="@var51"></A><A NAME="var:OCAMLMKTOP"></A> The OCaml toploop compiler (default <CODE>ocamlmktop</CODE>).

<H3 CLASS="subsection"><A NAME="htoc367">11.4.11</A>&nbsp;&nbsp;OCAMLLINK</H3><A NAME="@default325"></A><A NAME="@var52"></A><A NAME="var:OCAMLLINK"></A> The OCaml bytecode linker (default <CODE>$(OCAMLC)</CODE>).

<H3 CLASS="subsection"><A NAME="htoc368">11.4.12</A>&nbsp;&nbsp;OCAMLOPTLINK</H3><A NAME="@default326"></A><A NAME="@var53"></A><A NAME="var:OCAMLOPTLINK"></A> The OCaml native-code linker (default <CODE>$(OCAMLOPT)</CODE>).

<H3 CLASS="subsection"><A NAME="htoc369">11.4.13</A>&nbsp;&nbsp;OCAMLINCLUDES</H3><A NAME="@default327"></A><A NAME="@var54"></A><A NAME="var:OCAMLINCLUDES"></A> Search path to pass to the OCaml compilers (default <CODE>.</CODE>).
 The search path with the <CODE>-I</CODE> prefix is defined by the <CODE>PREFIXED_OCAMLINCLUDES</CODE>
 variable.

<H3 CLASS="subsection"><A NAME="htoc370">11.4.14</A>&nbsp;&nbsp;OCAMLFIND</H3><A NAME="@default328"></A><A NAME="@var55"></A><A NAME="var:OCAMLFIND"></A> The <CODE>ocamlfind</CODE> utility (default <CODE>ocamlfind</CODE> if
 <CODE>USE_OCAMLFIND</CODE> is set, otherwise empty).

<H3 CLASS="subsection"><A NAME="htoc371">11.4.15</A>&nbsp;&nbsp;OCAMLFINDFLAGS</H3><A NAME="@default329"></A><A NAME="@var56"></A><A NAME="var:OCAMLFINDFLAGS"></A> The flags to pass to <CODE>ocamlfind</CODE> (default empty, <CODE>USE_OCAMLFIND</CODE> must be set).

<H3 CLASS="subsection"><A NAME="htoc372">11.4.16</A>&nbsp;&nbsp;OCAMLPACKS</H3><A NAME="@default330"></A><A NAME="@var57"></A><A NAME="var:OCAMLPACKS"></A> Package names to pass to <CODE>ocamlfind</CODE> (<CODE>USE_OCAMLFIND</CODE> must be set).

<H3 CLASS="subsection"><A NAME="htoc373">11.4.17</A>&nbsp;&nbsp;BYTE_ENABLED</H3><A NAME="@default331"></A><A NAME="@var58"></A><A NAME="var:BYTE_ENABLED"></A> Flag indicating whether to use the bytecode compiler (default <CODE>true</CODE>, when no <CODE>ocamlopt</CODE> found, <CODE>false</CODE> otherwise).

<H3 CLASS="subsection"><A NAME="htoc374">11.4.18</A>&nbsp;&nbsp;NATIVE_ENABLED</H3><A NAME="@default332"></A><A NAME="@var59"></A><A NAME="var:NATIVE_ENABLED"></A> Flag indicating whether to use the native-code compiler (default <CODE>true</CODE>, when ocamlopt is found, <CODE>false</CODE> otherwise).
 Both <CODE>BYTE_ENABLED</CODE> and <CODE>NATIVE_ENABLED</CODE> can be set to true;
 at least one should be set to true.

<H3 CLASS="subsection"><A NAME="htoc375">11.4.19</A>&nbsp;&nbsp;OCaml command flags</H3>
The following variables specify additional options to be passed to
the OCaml tools.

<H3 CLASS="subsection"><A NAME="htoc376">11.4.20</A>&nbsp;&nbsp;OCAMLDEPFLAGS</H3><A NAME="@default333"></A><A NAME="@var60"></A><A NAME="var:OCAMLDEPFLAGS"></A> Flags to pass to <CODE>OCAMLDEP</CODE>.

<H3 CLASS="subsection"><A NAME="htoc377">11.4.21</A>&nbsp;&nbsp;OCAMLPPFLAGS</H3><A NAME="@default334"></A><A NAME="@var61"></A><A NAME="var:OCAMLPPFLAGS"></A> Flags to pass to <CODE>CAMLP4</CODE>.

<H3 CLASS="subsection"><A NAME="htoc378">11.4.22</A>&nbsp;&nbsp;OCAMLCFLAGS</H3><A NAME="@default335"></A><A NAME="@var62"></A><A NAME="var:OCAMLCFLAGS"></A> Flags to pass to the byte-code compiler (default <CODE>-g</CODE>).

<H3 CLASS="subsection"><A NAME="htoc379">11.4.23</A>&nbsp;&nbsp;OCAMLOPTFLAGS</H3><A NAME="@default336"></A><A NAME="@var63"></A><A NAME="var:OCAMLOPTFLAGS"></A> Flags to pass to the native-code compiler (default empty).

<H3 CLASS="subsection"><A NAME="htoc380">11.4.24</A>&nbsp;&nbsp;OCAMLFLAGS</H3><A NAME="@default337"></A><A NAME="@var64"></A><A NAME="var:OCAMLFLAGS"></A> Flags to pass to either compiler (default <CODE>-warn-error A</CODE>).

<H3 CLASS="subsection"><A NAME="htoc381">11.4.25</A>&nbsp;&nbsp;OCAML_BYTE_LINK_FLAGS</H3><A NAME="@default338"></A><A NAME="@var65"></A><A NAME="var:OCAML_BYTE_LINK_FLAGS"></A> Flags to pass to the byte-code linker (default empty).

<H3 CLASS="subsection"><A NAME="htoc382">11.4.26</A>&nbsp;&nbsp;OCAML_NATIVE_LINK_FLAGS</H3><A NAME="@default339"></A><A NAME="@var66"></A><A NAME="var:OCAML_NATIVE_LINK_FLAGS"></A> Flags to pass to the native-code linker (default empty).

<H3 CLASS="subsection"><A NAME="htoc383">11.4.27</A>&nbsp;&nbsp;OCAML_LINK_FLAGS</H3><A NAME="@default340"></A><A NAME="@var67"></A><A NAME="var:OCAML_LINK_FLAGS"></A> Flags to pass to either linker.

<H3 CLASS="subsection"><A NAME="htoc384">11.4.28</A>&nbsp;&nbsp;Library variables</H3>
The following variables are used during linking.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc385">11.4.29</A>&nbsp;&nbsp;OCAML_LIBS</H3><A NAME="@default341"></A><A NAME="@var68"></A><A NAME="var:OCAML_LIBS"></A> Libraries to pass to the linker. These libraries become dependencies
 of the link step.

<H3 CLASS="subsection"><A NAME="htoc386">11.4.30</A>&nbsp;&nbsp;OCAML_OTHER_LIBS</H3><A NAME="@default342"></A><A NAME="@var69"></A><A NAME="var:OCAML_OTHER_LIBS"></A> Additional libraries to pass to the linker. These libraries are
 <EM>not</EM> included as dependencies to the link step. Typical use is for the OCaml
 standard libraries like <CODE>unix</CODE> or <CODE>str</CODE>.

<H3 CLASS="subsection"><A NAME="htoc387">11.4.31</A>&nbsp;&nbsp;OCAML_CLIBS</H3><A NAME="@default343"></A><A NAME="@var70"></A><A NAME="var:OCAML_CLIBS"></A> C libraries to pass to the linker.

<H3 CLASS="subsection"><A NAME="htoc388">11.4.32</A>&nbsp;&nbsp;OCAML_LIB_FLAGS</H3><A NAME="@default344"></A><A NAME="@var71"></A><A NAME="var:OCAML_LIB_FLAGS"></A> Extra flags for the library.

<H3 CLASS="subsection"><A NAME="htoc389">11.4.33</A>&nbsp;&nbsp;OCamlGeneratedFiles</H3><A NAME="@default345"></A><A NAME="@fun202"></A><A NAME="fun:OCamlGeneratedFiles"></A>

<H3 CLASS="subsection"><A NAME="htoc390">11.4.34</A>&nbsp;&nbsp;LocalOCamlGeneratedFiles</H3><A NAME="@default346"></A><A NAME="@fun203"></A><A NAME="fun:LocalOCamlGeneratedFiles"></A>
<PRE CLASS="verbatim">
OCamlGeneratedFiles(files)
LocalOCamlGeneratedFiles(files)
</PRE>
The <CODE>OCamlGeneratedFiles</CODE> and <CODE>LocalOCamlGeneratedFiles</CODE> functions specify files
that need to be generated before any OCaml files are scanned for dependencies. For example,
if <CODE>parser.ml</CODE> and <CODE>lexer.ml</CODE> are both generated files, specify:
<PRE CLASS="verbatim">
OCamlGeneratedFiles(parser.ml lexer.ml)
</PRE>
The <CODE>OCamlGeneratedFiles</CODE> function is <EM>global</EM> &mdash; its arguments will be generated
before any OCaml files anywhere in the project are scanned for dependencies. The
<CODE>LocalOCamlGeneratedFiles</CODE> function follows the normal scoping rules of OMake.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc391">11.4.35</A>&nbsp;&nbsp;OCamlLibrary</H3><A NAME="@default347"></A><A NAME="@fun204"></A><A NAME="fun:OCamlLibrary"></A>
The <CODE>OCamlLibrary</CODE> function builds an OCaml library.<BR>
<BR>
<CODE>OCamlLibrary(&lt;libname&gt;, &lt;files&gt;)</CODE><BR>
<BR>
The <CODE>&lt;libname&gt;</CODE> and <CODE>&lt;files&gt;</CODE> are listed <EM>without</EM> suffixes.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc392">11.4.36</A>&nbsp;&nbsp;ABORT_ON_DEPENDENCY_ERRORS</H3><A NAME="@default348"></A><A NAME="@var72"></A><A NAME="var:ABORT_ON_DEPENDENCY_ERRORS"></A>
 The linker requires that the files to be
 listed in dependency order. If this variable is true, the order of
 the files is determined by the command line, but <TT>omake</TT> will
 abort with an error message if the order is illegal. Otherwise,
 the files are sorted automatically.<BR>
<BR>
This function returns the list of all the targets that it defines the rules
for (including the <CODE>$(name)$(EXT_LIB)</CODE> file when <CODE>NATIVE_ENABLED</CODE> is set).<BR>
<BR>
The following code builds the <CODE>libfoo.cmxa</CODE> library from the files <CODE>foo.cmx</CODE>
and <CODE>bar.cmx</CODE> (if <CODE>NATIVE_ENABLED</CODE> is set), and <CODE>libfoo.cma</CODE> from
<CODE>foo.cmo</CODE> and <CODE>bar.cmo</CODE> (if <CODE>BYTE_ENABLED</CODE> is set).
<PRE CLASS="verbatim">
OCamlLibrary(libfoo, foo bar)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc393">11.4.37</A>&nbsp;&nbsp;OCamlPackage</H3><A NAME="@default349"></A><A NAME="@fun205"></A><A NAME="fun:OCamlPackage"></A>
The <CODE>OCamlPackage</CODE> function builds an OCaml package.<BR>
<BR>
<CODE>OCamlPackage(&lt;name&gt;, &lt;files&gt;)</CODE><BR>
<BR>
The <CODE>&lt;name&gt;</CODE> and <CODE>&lt;files&gt;</CODE> are listed <EM>without</EM> suffixes.
The <CODE>&lt;files&gt;</CODE> must have been compiled with the <CODE>-for-pack &lt;ident&gt;</CODE>
flag to the OCaml compiler.<BR>
<BR>
This function returns the list of all the targets that it defines the rules
for (including the <CODE>$(name)$(EXT_LIB)</CODE> file when <CODE>NATIVE_ENABLED</CODE> is set).<BR>
<BR>
The following code builds the <CODE>libfoo.cmx</CODE> package from the files <CODE>package.cmx</CODE>
and <CODE>bar.cmx</CODE> (if <CODE>NATIVE_ENABLED</CODE> is set), and <CODE>package.cmo</CODE> from
<CODE>foo.cmo</CODE> and <CODE>bar.cmo</CODE> (if <CODE>BYTE_ENABLED</CODE> is set).
<PRE CLASS="verbatim">
OCamlPackage(package, foo bar)
</PRE>
<H3 CLASS="subsection"><A NAME="htoc394">11.4.38</A>&nbsp;&nbsp;OCamlLibraryCopy</H3><A NAME="@default350"></A><A NAME="@fun206"></A><A NAME="fun:OCamlLibraryCopy"></A>
The <CODE>OCamlLibraryCopy</CODE> function copies a library to an install location.<BR>
<BR>
<CODE>OCamlLibraryCopy(&lt;tag&gt;, &lt;libdir&gt;, &lt;libname&gt;, &lt;interface-files&gt;)</CODE><BR>
<BR>
The <CODE>&lt;interface-files&gt;</CODE> specify additional interface files
to be copied if the <CODE>INSTALL_INTERFACES</CODE> variable is true.

<H3 CLASS="subsection"><A NAME="htoc395">11.4.39</A>&nbsp;&nbsp;OCamlLibraryInstall</H3><A NAME="@default351"></A><A NAME="@fun207"></A><A NAME="fun:OCamlLibraryInstall"></A>
The <CODE>OCamlLibraryInstall</CODE> function builds a library
and copies it to an install location in one step.<BR>
<BR>
<CODE>OCamlLibraryInstall(&lt;tag&gt;, &lt;libdir&gt;, &lt;libname&gt;, &lt;files&gt;)</CODE>

<H3 CLASS="subsection"><A NAME="htoc396">11.4.40</A>&nbsp;&nbsp;OCamlProgram</H3><A NAME="@default352"></A><A NAME="@fun208"></A><A NAME="fun:OCamlProgram"></A>
The <CODE>OCamlProgram</CODE> function builds an OCaml program. It returns the array with all
the targets for which it have defined the rules (<CODE>$(name)$(EXE)</CODE> and <CODE>$(name).run</CODE>
and/or <CODE>$(name).opt</CODE>, depending on the <CODE>NATIVE_ENABLED</CODE> and <CODE>BYTE_ENABLED</CODE>
variables).<BR>
<BR>
<CODE>OCamlProgram(&lt;name&gt;, &lt;files&gt;)</CODE><BR>
<BR>
Additional variables used:
<DL CLASS="description" COMPACT=compact><DT CLASS="dt-description">
<B>OCAML_LIBS&nbsp;</B><A HREF="#var:OCAML_LIBS"><B>11.4.29</B></A><DD CLASS="dd-description"> Additional libraries passed to the linker, without suffix. These files
 become dependencies of the target program.
<DT CLASS="dt-description"><B>OCAML_OTHER_LIBS&nbsp;</B><A HREF="#var:OCAML_OTHER_LIBS"><B>11.4.30</B></A><DD CLASS="dd-description"> Additional libraries passed to the linker, without suffix. These
 files do <EM>not</EM> become dependencies of the target program.
<DT CLASS="dt-description"><B>OCAML_CLIBS&nbsp;</B><A HREF="#var:OCAML_CLIBS"><B>11.4.31</B></A><DD CLASS="dd-description"> C libraries to pass to the linker.
<DT CLASS="dt-description"><B>OCAML_BYTE_LINK_FLAGS&nbsp;</B><A HREF="#var:OCAML_BYTE_LINK_FLAGS"><B>11.4.25</B></A><DD CLASS="dd-description"> Flags to pass to the bytecode linker.
<DT CLASS="dt-description"><B>OCAML_NATIVE_LINK_FLAGS&nbsp;</B><A HREF="#var:OCAML_NATIVE_LINK_FLAGS"><B>11.4.26</B></A><DD CLASS="dd-description"> Flags to pass to the native code linker.
<DT CLASS="dt-description"><B>OCAML_LINK_FLAGS&nbsp;</B><A HREF="#var:OCAML_LINK_FLAGS"><B>11.4.27</B></A><DD CLASS="dd-description"> Flags to pass to both linkers.
</DL>

<H3 CLASS="subsection"><A NAME="htoc397">11.4.41</A>&nbsp;&nbsp;OCamlProgramCopy</H3><A NAME="@default353"></A><A NAME="@fun209"></A><A NAME="fun:OCamlProgramCopy"></A>
The <CODE>OCamlProgramCopy</CODE> function copies an OCaml program to an install location.<BR>
<BR>
<CODE>OCamlProgramCopy(&lt;tag&gt;, &lt;bindir&gt;, &lt;name&gt;)</CODE><BR>
<BR>
Additional variables used:
<DL CLASS="description" COMPACT=compact><DT CLASS="dt-description">
<B>NATIVE_ENABLED</B><DD CLASS="dd-description"> If <CODE>NATIVE_ENABLED</CODE>&nbsp;<A HREF="#var:NATIVE_ENABLED">11.4.18</A> is set, the native-code executable
 is copied; otherwise the byte-code executable is copied.
</DL>

<H3 CLASS="subsection"><A NAME="htoc398">11.4.42</A>&nbsp;&nbsp;OCamlProgramInstall</H3><A NAME="@default354"></A><A NAME="@fun210"></A><A NAME="fun:OCamlProgramInstall"></A>
The <CODE>OCamlProgramInstall</CODE> function builds a programs and copies it to
an install location in one step.<BR>
<BR>
<CODE>OCamlProgramInstall(&lt;tag&gt;, &lt;bindir&gt;, &lt;name&gt;, &lt;files&gt;)</CODE>
<A NAME="toc83"></A>
<H2 CLASS="section"><A NAME="htoc399">11.5</A>&nbsp;&nbsp;Building L<sup>A</sup>T<sub>E</sub>X programs</H2>

<H3 CLASS="subsection"><A NAME="htoc400">11.5.1</A>&nbsp;&nbsp;Configuration variables</H3>
The following variables can be modified in your project.

<H3 CLASS="subsection"><A NAME="htoc401">11.5.2</A>&nbsp;&nbsp;LATEX</H3><A NAME="@default355"></A><A NAME="@var73"></A><A NAME="var:LATEX"></A> The L<sup>A</sup>T<sub>E</sub>X command (default <CODE>latex</CODE>).

<H3 CLASS="subsection"><A NAME="htoc402">11.5.3</A>&nbsp;&nbsp;TETEX2_ENABLED</H3><A NAME="@default356"></A><A NAME="@var74"></A><A NAME="var:TETEX2_ENABLED"></A> Flag indicating whether to use advanced L<sup>A</sup>T<sub>E</sub>X options
present in TeTeX v.2 (default value is determined the first time omake reads <CODE>LaTeX.src</CODE>
and depends on the version of L<sup>A</sup>T<sub>E</sub>X you have installed).

<H3 CLASS="subsection"><A NAME="htoc403">11.5.4</A>&nbsp;&nbsp;LATEXFLAGS</H3><A NAME="@default357"></A><A NAME="@var75"></A><A NAME="var:LATEXFLAGS"></A> The L<sup>A</sup>T<sub>E</sub>X flags (defaults depend on the <CODE>TETEX2_ENABLED</CODE> variable)

<H3 CLASS="subsection"><A NAME="htoc404">11.5.5</A>&nbsp;&nbsp;BIBTEX</H3><A NAME="@default358"></A><A NAME="@var76"></A><A NAME="var:BIBTEX"></A> The BibTeX command (default <CODE>bibtex</CODE>).

<H3 CLASS="subsection"><A NAME="htoc405">11.5.6</A>&nbsp;&nbsp;MAKEINDEX</H3><A NAME="@default359"></A><A NAME="@var77"></A><A NAME="var:MAKEINDEX"></A> The command to build an index (default <CODE>makeindex</CODE>).

<H3 CLASS="subsection"><A NAME="htoc406">11.5.7</A>&nbsp;&nbsp;DVIPS</H3><A NAME="@default360"></A><A NAME="@var78"></A><A NAME="var:DVIPS"></A> The <CODE>.dvi</CODE> to PostScript converter (default <CODE>dvips</CODE>).

<H3 CLASS="subsection"><A NAME="htoc407">11.5.8</A>&nbsp;&nbsp;DVIPSFLAGS</H3><A NAME="@default361"></A><A NAME="@var79"></A><A NAME="var:DVIPSFLAGS"></A> Flags to pass to <CODE>dvips</CODE> (default <CODE>-t letter</CODE>).

<H3 CLASS="subsection"><A NAME="htoc408">11.5.9</A>&nbsp;&nbsp;DVIPDFM</H3><A NAME="@default362"></A><A NAME="@var80"></A><A NAME="var:DVIPDFM"></A> The <CODE>.dvi</CODE> to <CODE>.pdf</CODE> converter (default <CODE>dvipdfm</CODE>).

<H3 CLASS="subsection"><A NAME="htoc409">11.5.10</A>&nbsp;&nbsp;DVIPDFMFLAGS</H3><A NAME="@default363"></A><A NAME="@var81"></A><A NAME="var:DVIPDFMFLAGS"></A> Flags to pass to <CODE>dvipdfm</CODE> (default <CODE>-p letter</CODE>).

<H3 CLASS="subsection"><A NAME="htoc410">11.5.11</A>&nbsp;&nbsp;PDFLATEX</H3><A NAME="@default364"></A><A NAME="@var82"></A><A NAME="var:PDFLATEX"></A> The <CODE>.latex</CODE> to <CODE>.pdf</CODE> converter (default <CODE>pdflatex</CODE>).

<H3 CLASS="subsection"><A NAME="htoc411">11.5.12</A>&nbsp;&nbsp;PDFLATEXFLAGS</H3><A NAME="@default365"></A><A NAME="@var83"></A><A NAME="var:PDFLATEXFLAGS"></A> Flags to pass to pdflatex (default is empty).

<H3 CLASS="subsection"><A NAME="htoc412">11.5.13</A>&nbsp;&nbsp;USEPDFLATEX</H3><A NAME="@default366"></A><A NAME="@var84"></A><A NAME="var:USEPDFLATEX"></A> Flag indicating whether to use pdflatex instead of dvipdfm
to generate the <CODE>.pdf</CODE> document (default <CODE>false</CODE>).

<H3 CLASS="subsection"><A NAME="htoc413">11.5.14</A>&nbsp;&nbsp;LaTeXDocument</H3><A NAME="@default367"></A><A NAME="@fun211"></A><A NAME="fun:LaTeXDocument"></A>
The <CODE>LaTeXDocument</CODE> produces a L<sup>A</sup>T<sub>E</sub>X document.<BR>
<BR>
<CODE>LaTeXDocument(&lt;name&gt;, &lt;texfiles&gt;)</CODE><BR>
<BR>
The document <CODE>&lt;name&gt;</CODE> and <CODE>&lt;texfiles&gt;</CODE> are listed without suffixes. This function
returns the filenames for the generated <CODE>.ps</CODE> and <CODE>.pdf</CODE> files.<BR>
<BR>
Additional variables used:

<H3 CLASS="subsection"><A NAME="htoc414">11.5.15</A>&nbsp;&nbsp;TEXINPUTS</H3><A NAME="@default368"></A><A NAME="@var85"></A><A NAME="var:TEXINPUTS"></A>
The L<sup>A</sup>T<sub>E</sub>X search path (an array of directories, default is
 taken from the <CODE>TEXINPUTS</CODE> environment variable).

<H3 CLASS="subsection"><A NAME="htoc415">11.5.16</A>&nbsp;&nbsp;TEXDEPS</H3><A NAME="@default369"></A><A NAME="@var86"></A><A NAME="var:TEXDEPS"></A> Additional files this document depends on.

<H3 CLASS="subsection"><A NAME="htoc416">11.5.17</A>&nbsp;&nbsp;TeXGeneratedFiles</H3><A NAME="@default370"></A><A NAME="@fun212"></A><A NAME="fun:TeXGeneratedFiles"></A>

<H3 CLASS="subsection"><A NAME="htoc417">11.5.18</A>&nbsp;&nbsp;LocalTeXGeneratedFiles</H3><A NAME="@default371"></A><A NAME="@fun213"></A><A NAME="fun:LocalTeXGeneratedFiles"></A>
<PRE CLASS="verbatim">
TeXGeneratedFiles(files)
LocalTeXGeneratedFiles(files)
</PRE>
The <CODE>TeXGeneratedFiles</CODE> and <CODE>LocalTeXGeneratedFiles</CODE> functions specify files
that need to be generated before any L<sup>A</sup>T<sub>E</sub>Xfiles are scanned for dependencies. For example,
if <CODE>config.tex</CODE> and <CODE>inputs.tex</CODE> are both generated files, specify:
<PRE CLASS="verbatim">
    TeXGeneratedFiles(config.tex inputs.tex)
</PRE>
The <CODE>TeXGeneratedFiles</CODE> function is <EM>global</EM> &mdash; its arguments will be generated
before any TeX files anywhere in the project are scanned for dependencies. The
<CODE>LocalTeXGeneratedFiles</CODE> function follows the normal scoping rules of OMake.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc418">11.5.19</A>&nbsp;&nbsp;LaTeXDocumentCopy</H3><A NAME="@default372"></A><A NAME="@fun214"></A><A NAME="fun:LaTeXDocumentCopy"></A>
The <CODE>LaTeXDocumentCopy</CODE> copies the document to an install location.<BR>
<BR>
<CODE>LaTeXDocumentCopy(&lt;tag&gt;, &lt;libdir&gt;, &lt;installname&gt;, &lt;docname&gt;)</CODE><BR>
<BR>
This function copies just the <CODE>.pdf</CODE> and <CODE>.ps</CODE> files.

<H3 CLASS="subsection"><A NAME="htoc419">11.5.20</A>&nbsp;&nbsp;LaTeXDocumentInstall</H3><A NAME="@default373"></A><A NAME="@fun215"></A><A NAME="fun:LaTeXDocumentInstall"></A>
The <CODE>LaTeXDocumentInstall</CODE> builds a document and copies it to an
install location in one step.<BR>
<BR>
<CODE>LaTeXDocumentInstall(&lt;tag&gt;, &lt;libdir&gt;, &lt;installname&gt;, &lt;docname&gt;, &lt;files&gt;)</CODE>
<A NAME="toc84"></A>
<H2 CLASS="section"><A NAME="htoc420">11.6</A>&nbsp;&nbsp;Examining the dependency graph</H2>

<H3 CLASS="subsection"><A NAME="htoc421">11.6.1</A>&nbsp;&nbsp;dependencies</H3><A NAME="@default374"></A><A NAME="@fun216"></A><A NAME="fun:dependencies"></A>

<H3 CLASS="subsection"><A NAME="htoc422">11.6.2</A>&nbsp;&nbsp;dependencies-all</H3><A NAME="@default375"></A><A NAME="@fun217"></A><A NAME="fun:dependencies-all"></A>
<PRE CLASS="verbatim">
   $(dependencies targets) : File Array
   $(dependencies-all targets) : File Array
   $(dependencies-proper targets) : File Array
      targets : File Array
   raises RuntimeException
</PRE>
The <CODE>dependencies</CODE> function returns the set of immediate dependencies of
the given targets. This function can only be used within a rule body and
all the arguments to the <CODE>dependency</CODE> function must also be dependencies of
this rule. This restriction ensures that all the dependencies are known when
this function is executed.<BR>
<BR>
The <CODE>dependencies-all</CODE> function is similar, but it expands the dependencies
recursively, returning all of the dependencies of a target, not just the immediate
ones.<BR>
<BR>
The <CODE>dependencies-proper</CODE> function returns all recursive dependencies, except
the dependencies that are leaf targets. A leaf target is a target that has no
dependencies and no build commands; a leaf target corresponds to a source file
in the current project.<BR>
<BR>
In all three functions, files that are not part of the current project are silently
discarded.<BR>
<BR>
One purpose of the <CODE>dependencies-proper</CODE> function is for &#8220;clean&#8221; targets.
For example, one way to delete all intermediate files in a build is with a rule
that uses the <CODE>dependencies-proper</CODE>. Note however, that the rule requires
building the project before it can be deleted. For a shorter form, see the
<CODE>filter-proper-targets</CODE> function.
<PRE CLASS="verbatim">
    .PHONY: clean

    APP = ...     # the name of the target application
    clean: $(APP)
       rm $(dependencies-proper $(APP))
</PRE>

<H3 CLASS="subsection"><A NAME="htoc423">11.6.3</A>&nbsp;&nbsp;target</H3><A NAME="@default376"></A><A NAME="@fun218"></A><A NAME="fun:target"></A>
<PRE CLASS="verbatim">
   $(target targets) : Rule Array
      targets : File Sequence
   raises RuntimeException
</PRE>
The <CODE>target</CODE> function returns the Target object associated with each
of the targets. See the <CODE>Target</CODE> object for more information.

<H3 CLASS="subsection"><A NAME="htoc424">11.6.4</A>&nbsp;&nbsp;rule</H3><A NAME="@default377"></A><A NAME="@fun219"></A><A NAME="fun:rule"></A>
The <CODE>rule</CODE> function is called whenever a build rule is defined.
It is unlikely that you will need to redefine this function, except in
very exceptional cases.
<PRE CLASS="verbatim">
   rule(multiple, target, pattern, sources, options, body) : Rule
      multiple : String
      target   : Sequence
      pattern  : Sequence
      sources  : Sequence
      options  : Array
      body     : Body
</PRE>
The <CODE>rule</CODE> function is called when a rule is evaluated.
<DL CLASS="description" COMPACT=compact><DT CLASS="dt-description">
<B>multiple</B><DD CLASS="dd-description"> A Boolean value indicating whether the rule was defined
 with a double colon <CODE>::</CODE>.
<DT CLASS="dt-description"><B>target</B><DD CLASS="dd-description"> The sequence of target names.
<DT CLASS="dt-description"><B>pattern</B><DD CLASS="dd-description"> The sequence of patterns. This sequence will be empty
 for two-part rules.
<DT CLASS="dt-description"><B>sources</B><DD CLASS="dd-description"> The sequence of dependencies.
<DT CLASS="dt-description"><B>options</B><DD CLASS="dd-description"> An array of options. Each option is represented
 as a two-element array with an option name, and the option value.
<DT CLASS="dt-description"><B>body</B><DD CLASS="dd-description"> The body expression of the rule.
</DL>
Consider the following rule.
<PRE CLASS="verbatim">
   target: pattern: sources :name1: option1 :name2: option2
      expr1
      expr2
</PRE>
This expression represents the following function call, where
square brackets are used to indicate arrays.
<PRE CLASS="verbatim">
   rule(false, target, pattern, sources,
        [[:name1:, option1], [:name2:, option2]]
        [expr1; expr2])
</PRE>

<TABLE CELLSPACING=2 CELLPADDING=0>
<TR><TD ALIGN=left NOWRAP>Jump to:</TD>
<TD VALIGN=top ALIGN=center NOWRAP>&nbsp;&nbsp;</TD>
<TD ALIGN=left NOWRAP><A HREF="http://omake.metaprl.org/">OMake Home</A>
&bull;&nbsp;<A HREF="omake.html">Guide Home</A>
&bull;&nbsp;<A HREF="omake-doc.html">Guide (single-page)</A>
&bull;&nbsp;<A HREF="omake-toc.html">Contents (short)</A>
&bull;&nbsp;<A HREF="omake-contents.html">Contents (long)</A></TD>
</TR>
<TR><TD ALIGN=left NOWRAP>Index:</TD>
<TD VALIGN=top ALIGN=center NOWRAP>&nbsp;&nbsp;</TD>
<TD ALIGN=left NOWRAP><A HREF="omake-all-index.html">All</A>
&bull;&nbsp;<A HREF="omake-var-index.html">Variables</A>
&bull;&nbsp;<A HREF="omake-fun-index.html">Functions</A>
&bull;&nbsp;<A HREF="omake-obj-index.html">Objects</A>
&bull;&nbsp;<A HREF="omake-target-index.html">Targets</A></TD>
</TR></TABLE>
</BODY>
</HTML>
