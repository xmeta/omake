<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>



<META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<META name="GENERATOR" content="hevea 1.08">
<LINK rel="stylesheet" type="text/css" href="omake-doc.css">
<TITLE>
The OSH shell
</TITLE>
</HEAD>
<BODY >
<A HREF="omake-rule.html"><IMG SRC ="previous_motif.gif" ALT="Previous"></A>
<A HREF="omake-toc.html"><IMG SRC ="contents_motif.gif" ALT="Up"></A>
<A HREF="omake-options.html"><IMG SRC ="next_motif.gif" ALT="Next"></A>
<HR>
<A HREF="http://omake.metaprl.org/">OMake Home</A>
<A HREF="omake-toc.html">Table of contents</A>
<A HREF="omake.html">Guide</A>
<A HREF="omake-options.html">Options</A>
<A HREF="omake-all-index.html">Index</A>
<A HREF="omake-var-index.html">Variables</A>
<A HREF="omake-fun-index.html">Functions</A>
<A HREF="omake-obj-index.html">Objects</A>
<A HREF="omake-target-index.html">Targets</A>

<H1 CLASS="chapter"><A NAME="htoc424">Chapter&nbsp;12</A>&nbsp;&nbsp;The OSH shell</H1><UL>
<LI><A HREF="osh.html#toc85">Startup</A>
<LI><A HREF="osh.html#toc86">Aliases</A>
<LI><A HREF="osh.html#toc87">Interactive syntax</A>
</UL>

<A NAME="chapter:osh"></A>
<BR>
<BR>
OMake also includes a standalone command-line interpreter <TT>osh</TT> that can be used as an
interactive shell. The shell uses the same syntax, and provides the same features on all platforms
<TT>omake</TT> supports, including Win32.<BR>
<BR>
<A NAME="toc85"></A>
<H2 CLASS="section"><A NAME="htoc425">12.1</A>&nbsp;&nbsp;Startup</H2>
On startup, <TT>osh</TT> reads the file <CODE>~/.oshrc</CODE> if it exists. The syntax of this file is the
same as an <TT>OMakefile</TT>. The following additional variables are significant.<BR>
<BR>

<H3 CLASS="subsection"><A NAME="htoc426">12.1.1</A>&nbsp;&nbsp;prompt</H3><A NAME="@default377"></A><A NAME="@var86"></A><A NAME="var:prompt"></A> The <CODE>prompt</CODE> variable specifies the command-line prompt.
It can be a simple string.
<PRE CLASS="verbatim">
    prompt = osh&gt;
</PRE>
Or you may choose to define it as a function of no arguments.
<PRE CLASS="verbatim">
    prompt() =
        return $"&lt;$(USER):$(HOST) $(homename $(CWD))&gt;"
</PRE>
An example of the latter prompt is as follows.
<PRE CLASS="verbatim">
    &lt;jyh:kenai.yapper.org ~&gt;cd links/omake
    &lt;jyh:kenai.yapper.org ~/links/omake&gt;
</PRE>

<H3 CLASS="subsection"><A NAME="htoc427">12.1.2</A>&nbsp;&nbsp;ignoreeof</H3><A NAME="@default378"></A><A NAME="@var87"></A><A NAME="var:ignoreeof"></A>
 If the <CODE>ignoreeof</CODE> is <CODE>true</CODE>, then <CODE>osh</CODE> will not exit on
 a terminal end-of-file (usually <CODE>^D</CODE> on Unix systems).<BR>
<BR>
<A NAME="toc86"></A>
<H2 CLASS="section"><A NAME="htoc428">12.2</A>&nbsp;&nbsp;Aliases</H2>
<A NAME="@default379"></A>
Command aliases are defined by adding functions to the <CODE>Shell.</CODE> object. The following alias
adds the <CODE>-AF</CODE> option to the <CODE>ls</CODE> command.
<PRE CLASS="verbatim">
    Shell. +=
       ls(argv) =
          "ls" -AF $(argv)
</PRE>
Quoted commands do not undergo alias expansion. The quotation <CODE>"ls"</CODE> prevents the alias from
being recursive.<BR>
<BR>
<A NAME="toc87"></A>
<H2 CLASS="section"><A NAME="htoc429">12.3</A>&nbsp;&nbsp;Interactive syntax</H2>
The interactive syntax in <CODE>osh</CODE> is the same as the syntax of an <CODE>OMakefile</CODE>, with one
exception in regard to indentation. The line before an indented block must have a colon at the end
of the line. A block is terminated with a <CODE>.</CODE> on a line by itself, or <CODE>^D</CODE>. In the
following example, the first line <CODE>if true</CODE> has no body, because there is no colon.
<PRE CLASS="verbatim">
   # The following if has no body
   osh&gt;if true
   # The following if has a body
   osh&gt;if true:
   if&gt;       if true:
   if&gt;          println(Hello world)
   if&gt;          .
   Hello world
</PRE>
Note that <CODE>osh</CODE> makes some effort to modify the prompt while in an indented body, and it
auto-indents the text.<BR>
<BR>
The colon signifier is also allowed in files, although it is not required.<BR>
<BR>

<A HREF="http://omake.metaprl.org/">OMake Home</A>
<A HREF="omake-toc.html">Table of contents</A>
<A HREF="omake.html">Guide</A>
<A HREF="omake-options.html">Options</A>
<A HREF="omake-all-index.html">Index</A>
<A HREF="omake-var-index.html">Variables</A>
<A HREF="omake-fun-index.html">Functions</A>
<A HREF="omake-obj-index.html">Objects</A>
<A HREF="omake-target-index.html">Targets</A>
<HR>
<A HREF="omake-rule.html"><IMG SRC ="previous_motif.gif" ALT="Previous"></A>
<A HREF="omake-toc.html"><IMG SRC ="contents_motif.gif" ALT="Up"></A>
<A HREF="omake-options.html"><IMG SRC ="next_motif.gif" ALT="Next"></A>
</BODY>
</HTML>
