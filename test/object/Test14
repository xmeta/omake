Test(map) =
   map.foreach(key, val)
      map = $(map.add $(key), new)
      export map

   new = $(map.find key)
   if $(not $(equal $(new), new))
      println($"Error: expected new, got $(new)")
      exit 1

X. =
   extends $(Map)
   $|key| = old

Test($X)
